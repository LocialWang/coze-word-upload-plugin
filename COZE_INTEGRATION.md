# Coze智能体集成指南

本文档专门介绍如何将Word文档上传插件集成到Coze智能体中。

## 🚀 快速开始

### 1. 启动插件服务

```bash
# 方式一：使用快速启动脚本（推荐）
./start.sh

# 方式二：手动启动
npm install  # 首次运行需要安装依赖
npm start
```

### 2. 验证服务状态

打开浏览器访问以下地址，确认服务正常：
- 健康检查: http://localhost:3000/health
- 测试界面: http://localhost:3000/static/index.html

## 📋 在Coze平台导入插件

### 方式一：上传YAML文件（推荐）

1. 打开Coze平台 -> 资源库 -> 插件
2. 点击"导入插件"
3. 选择"本地文件"选项卡
4. 上传项目根目录下的 `openapi.yaml` 文件
5. 等待导入完成

### 方式二：使用URL导入

1. 确保插件服务正在运行
2. 在Coze导入插件页面选择"URL和始数据"
3. 输入URL: `http://localhost:3000/openapi.yaml`
4. 点击导入

## 🔧 插件功能说明

导入成功后，智能体将获得以下能力：

### 主要接口

1. **uploadWordDocument** - 上传Word文档
   - 接受.docx格式文件
   - 自动提取文本内容
   - 返回文档信息和统计数据

2. **getDocument** - 获取文档内容
   - 根据文档ID查询内容
   - 返回完整文档信息

3. **getDocumentList** - 文档列表
   - 查看所有已上传文档
   - 显示基本信息和统计

4. **deleteDocument** - 删除文档
   - 根据ID删除指定文档
   - 清理相关数据

## 💬 智能体对话示例

### 上传文档

```
用户: 请帮我上传这个Word文档
智能体: 我来帮您上传Word文档。请提供您要上传的.docx文件。
[用户上传文件]
智能体: 文档上传成功！我已经提取了文档内容：
- 文件名: 工作报告.docx
- 字数统计: 1,250字
- 上传时间: 2024-01-15 18:30:00
- 文档ID: abc123...

以下是文档的主要内容：
[显示提取的文本内容]
```

### 查看文档历史

```
用户: 显示我之前上传的所有文档
智能体: 以下是您的文档列表：

1. 工作报告.docx
   - 字数: 1,250字
   - 上传时间: 2024-01-15 18:30:00
   - 文档ID: abc123...

2. 项目计划.docx
   - 字数: 800字
   - 上传时间: 2024-01-15 16:20:00
   - 文档ID: def456...

您需要查看哪个文档的详细内容吗？
```

### 查看特定文档

```
用户: 请显示第一个文档的内容
智能体: 正在为您获取"工作报告.docx"的内容...

文档详情：
- 文件名: 工作报告.docx
- 字数统计: 1,250字
- 上传时间: 2024-01-15 18:30:00

文档内容：
[显示完整的文档文本内容]
```

## ⚙️ 配置说明

### 服务器配置

默认配置：
- 端口: 3000
- 最大文件大小: 10MB
- 支持格式: .docx
- 存储方式: 本地文件系统

### 自定义配置

可以通过环境变量调整配置：

```bash
# 设置端口
export PORT=8080

# 启动服务
npm start
```

## 🛠️ 故障排除

### 常见问题

1. **插件导入失败**
   - 检查服务是否正在运行
   - 确认URL地址正确
   - 验证网络连接

2. **文档上传失败**
   - 确认文件格式为.docx
   - 检查文件大小不超过10MB
   - 查看服务器日志

3. **服务启动失败**
   - 检查Node.js版本 (>= 14)
   - 确认端口3000未被占用
   - 运行 `npm install` 重新安装依赖

### 调试方法

```bash
# 查看服务状态
curl http://localhost:3000/health

# 查看OpenAPI规范
curl http://localhost:3000/openapi.yaml

# 查看服务日志
npm run dev  # 开发模式，显示详细日志
```

## 🌐 生产环境部署

### 云服务器部署

1. 部署到云服务器
2. 配置域名和SSL证书
3. 更新 `openapi.yaml` 中的服务器地址
4. 在Coze中重新导入插件

### Docker部署

```bash
# 构建镜像
docker build -t coze-word-plugin .

# 运行容器
docker run -p 3000:3000 coze-word-plugin
```

## 📞 技术支持

如果在集成过程中遇到问题，请：

1. 查看项目README.md文档
2. 检查服务器日志
3. 访问测试界面进行功能验证
4. 联系技术支持: support@example.com

---

**注意**: 请确保在整个Coze智能体运行期间，插件服务保持启动状态。